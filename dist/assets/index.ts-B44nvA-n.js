var b=Object.defineProperty;var S=(a,r,e)=>r in a?b(a,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[r]=e;var c=(a,r,e)=>S(a,typeof r!="symbol"?r+"":r,e);import{i as w}from"./injector-Op4Q08O8.js";class u{constructor(){c(this,"observer",null);c(this,"turnCallbacks",[]);c(this,"turnCounter",0);c(this,"capturedHashes",new Set);c(this,"observedContainer",null);c(this,"observedSelector","");c(this,"observedRoleDetector",null)}stop(){this.observer&&(this.observer.disconnect(),this.observer=null)}onTurn(r){this.turnCallbacks.push(r)}emitTurn(r){for(const e of this.turnCallbacks)e(r)}hashMessage(r,e){const t=e.trim().slice(0,200);return`${r}::${t}`}createTurn(r,e,t){return this.turnCounter++,{id:`${this.platform}_turn_${this.turnCounter}_${Date.now()}`,role:r,content:e,timestamp:Date.now(),model:t,codeBlocks:this.extractCodeBlocks(e),toolCalls:[]}}extractCodeBlocks(r){const e=[],t=/```(\w*)\n([\s\S]*?)```/g;let s;for(;(s=t.exec(r))!==null;)e.push({language:s[1]||"text",code:s[2].trim()});return e}detectModel(){}observeContainer(r,e,t){this.observedContainer=r,this.observedSelector=e,this.observedRoleDetector=t,this.scanExistingMessages(r,e,t);let s=r.querySelectorAll(e).length;this.observer=new MutationObserver(()=>{const n=r.querySelectorAll(e);if(n.length>s){for(let o=s;o<n.length;o++){const i=n[o],d=t(i);if(d){const f=this.extractTextContent(i);if(f.trim()){const h=this.hashMessage(d,f);if(!this.capturedHashes.has(h)){this.capturedHashes.add(h);const y=this.createTurn(d,f,this.detectModel());this.emitTurn(y)}}}}s=n.length}}),this.observer.observe(r,{childList:!0,subtree:!0})}scanExistingMessages(r,e,t){const s=r.querySelectorAll(e);let n=0;for(const o of s){const i=t(o);if(i){const d=this.extractTextContent(o);if(d.trim()){const f=this.hashMessage(i,d);if(!this.capturedHashes.has(f)){this.capturedHashes.add(f);const h=this.createTurn(i,d,this.detectModel());this.emitTurn(h),n++}}}}n>0&&console.log(`[CLO] Captured ${n} existing messages from page`)}rescan(){this.observedContainer&&this.observedSelector&&this.observedRoleDetector&&(document.contains(this.observedContainer)?(console.log("[CLO] Re-scanning page for messages..."),this.scanExistingMessages(this.observedContainer,this.observedSelector,this.observedRoleDetector)):(console.log("[CLO] Container no longer in DOM, restarting interceptor..."),this.stop(),this.start()))}extractTextContent(r){var s,n;const e=r.cloneNode(!0),t=e.querySelectorAll("pre code, pre");for(const o of t){const i=((n=(s=o.className)==null?void 0:s.split(" ").find(d=>d.startsWith("language-")))==null?void 0:n.replace("language-",""))||"";o.textContent=`\`\`\`${i}
${o.textContent}
\`\`\``}return e.textContent||""}}class q extends u{constructor(){super(...arguments);c(this,"platform","chatgpt")}start(){console.log("[CLO] ChatGPT interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('main [class*="react-scroll-to-bottom"]')||document.querySelector("main .flex.flex-col");t?this.observeContainer(t,"[data-message-author-role]",this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.getAttribute("data-message-author-role");return t==="user"?"user":t==="assistant"?"assistant":t==="system"?"system":t==="tool"?"tool":null}detectModel(){const e=document.querySelector('[data-testid="model-switcher"] button span')||document.querySelector('button[aria-label] span[class*="text"]');if(e!=null&&e.textContent){const t=e.textContent.trim().toLowerCase();return t.includes("4o")?"gpt-4o":t.includes("4")?"gpt-4":t.includes("o1")?"o1":t.includes("o3")?"o3-mini":t}return"chatgpt-unknown"}}class x extends u{constructor(){super(...arguments);c(this,"platform","claude")}start(){console.log("[CLO] Claude interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="conversation-content"]')||document.querySelector('[data-testid="conversation-turn-list"]')||document.querySelector("main .flex.flex-col");t?this.observeContainer(t,'[class*="Message"], [data-testid*="message"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-testid")||"";if(t.includes("human")||s.includes("human")||s.includes("user"))return"user";if(t.includes("assistant")||s.includes("assistant")||s.includes("ai"))return"assistant";const n=e.querySelector('[class*="avatar"], [class*="icon"]');if(n){const o=n.className||"";if(o.includes("human")||o.includes("user"))return"user";if(o.includes("assistant")||o.includes("ai"))return"assistant"}return null}detectModel(){const e=document.querySelector('[data-testid="model-selector"] button')||document.querySelector('button[class*="model"]');if(e!=null&&e.textContent){const t=e.textContent.trim().toLowerCase();return t.includes("opus")?"claude-3-opus":t.includes("sonnet")?"claude-3.5-sonnet":t.includes("haiku")?"claude-3-haiku":t}return"claude-unknown"}}class k extends u{constructor(){super(...arguments);c(this,"platform","gemini")}start(){console.log("[CLO] Gemini interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector("chat-window")||document.querySelector('[class*="conversation"]')||document.querySelector("main");t?this.observeContainer(t,"message-content, [class*='message-content'], model-response, user-query",this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.tagName.toLowerCase();if(t==="user-query"||t.includes("user"))return"user";if(t==="model-response"||t.includes("model"))return"assistant";const s=e.className||"";if(s.includes("user")||s.includes("query"))return"user";if(s.includes("model")||s.includes("response"))return"assistant";const n=e.closest("[class*='user'], [class*='model']");if(n){const o=n.className||"";if(o.includes("user"))return"user";if(o.includes("model"))return"assistant"}return null}detectModel(){const e=document.querySelector('[class*="model-picker"]')||document.querySelector('[aria-label*="model"]');if(e!=null&&e.textContent){const t=e.textContent.trim().toLowerCase();return t.includes("2.0 flash")?"gemini-2.0-flash":t.includes("2.0 pro")?"gemini-2.0-pro":t.includes("1.5 pro")?"gemini-1.5-pro":t.includes("ultra")?"gemini-ultra":t}return"gemini-unknown"}}class L extends u{constructor(){super(...arguments);c(this,"platform","grok")}start(){console.log("[CLO] Grok interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="conversation"]')||document.querySelector('[class*="chat-container"]')||document.querySelector('[class*="message-list"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="message"], [class*="Message"], [data-testid*="message"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-testid")||"";if(t.includes("user")||s.includes("user")||s.includes("human"))return"user";if(t.includes("assistant")||t.includes("grok")||s.includes("assistant")||s.includes("grok"))return"assistant";const n=e.closest('[class*="user"], [class*="assistant"], [class*="grok"]');if(n){const o=n.className||"";if(o.includes("user"))return"user";if(o.includes("assistant")||o.includes("grok"))return"assistant"}return null}detectModel(){const e=document.querySelector('[class*="model"]')||document.querySelector('[data-testid*="model"]');if(e!=null&&e.textContent){const t=e.textContent.trim().toLowerCase();return t.includes("grok-3")?"grok-3":t.includes("grok-2")?"grok-2":t}return"grok-default"}}class M extends u{constructor(){super(...arguments);c(this,"platform","perplexity")}start(){console.log("[CLO] Perplexity interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="ConversationMessages"]')||document.querySelector('[class*="conversation"]')||document.querySelector('main [class*="flex"][class*="col"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="Message"], [class*="message-content"], [class*="prose"], [data-testid*="message"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"";e.innerHTML;const s=e.getAttribute("data-testid")||"";if(t.includes("user")||t.includes("query")||t.includes("UserMessage")||s.includes("user"))return"user";if(t.includes("answer")||t.includes("assistant")||t.includes("AssistantMessage")||t.includes("prose")||s.includes("assistant")||s.includes("answer"))return"assistant";const n=e.closest('[class*="user"], [class*="answer"], [class*="query"], [class*="assistant"]');if(n){const o=n.className||"";if(o.includes("user")||o.includes("query"))return"user";if(o.includes("answer")||o.includes("assistant"))return"assistant"}return null}detectModel(){const e=document.querySelector('[class*="ModelSelector"] button')||document.querySelector('[data-testid="model-selector"]')||document.querySelector('button[class*="model"]');if(e!=null&&e.textContent){const t=e.textContent.trim().toLowerCase();return t.includes("sonar")?"perplexity-sonar":t.includes("claude")?"claude-via-perplexity":t.includes("gpt")?"gpt-via-perplexity":t.includes("pro")?"perplexity-pro":t}return"perplexity-default"}}class R extends u{constructor(){super(...arguments);c(this,"platform","deepseek")}start(){console.log("[CLO] DeepSeek interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="chat-message-list"]')||document.querySelector('[class*="conversation"]')||document.querySelector('[id*="chat"]')||document.querySelector("main .flex.flex-col");t?this.observeContainer(t,'[class*="message"], [class*="chat-message"], [class*="markdown"], [data-role]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-role")||"";if(s==="user"||t.includes("user"))return"user";if(s==="assistant"||t.includes("assistant"))return"assistant";const n=e.closest('[data-role], [class*="user"], [class*="assistant"]');if(n){const i=n.getAttribute("data-role")||n.className||"";if(i.includes("user"))return"user";if(i.includes("assistant"))return"assistant"}const o=e.querySelector('[class*="avatar"], img[alt]');if(o){const i=o.getAttribute("alt")||"",d=o.className||"";if(i.includes("user")||d.includes("user"))return"user";if(i.includes("DeepSeek")||i.includes("assistant")||d.includes("assistant"))return"assistant"}return null}detectModel(){const e=document.querySelector('[class*="model-selector"]')||document.querySelector('[class*="ModelSelect"]')||document.querySelector('button[class*="model"]');if(e!=null&&e.textContent){const t=e.textContent.trim().toLowerCase();return t.includes("r1")?"deepseek-r1":t.includes("v3")?"deepseek-v3":t.includes("v2")?"deepseek-v2":t.includes("coder")?"deepseek-coder":t}return"deepseek-chat"}}class T extends u{constructor(){super(...arguments);c(this,"platform","kimi")}start(){console.log("[CLO] Kimi interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="chat-content"]')||document.querySelector('[class*="message-list"]')||document.querySelector('[class*="conversation"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="message"], [class*="segment"], [class*="chat-item"], [data-role]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-role")||"";if(s==="user"||t.includes("user"))return"user";if(s==="assistant"||t.includes("assistant")||t.includes("bot"))return"assistant";const n=e.closest('[data-role], [class*="user"], [class*="assistant"], [class*="bot"]');if(n){const o=n.getAttribute("data-role")||n.className||"";if(o.includes("user"))return"user";if(o.includes("assistant")||o.includes("bot"))return"assistant"}return null}detectModel(){const e=document.querySelector('[class*="model-name"]')||document.querySelector('[class*="ModelSelector"]');if(e!=null&&e.textContent){const t=e.textContent.trim().toLowerCase();return t.includes("k2")?"kimi-k2":t.includes("k1.5")?"kimi-k1.5":t.includes("k1")?"kimi-k1":t}return"kimi-default"}}class N extends u{constructor(){super(...arguments);c(this,"platform","manus")}start(){console.log("[CLO] Manus AI interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="chat-container"]')||document.querySelector('[class*="conversation"]')||document.querySelector('[class*="message-list"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="message"], [class*="chat-message"], [class*="bubble"], [data-role]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-role")||"";if(s==="user"||t.includes("user"))return"user";if(s==="assistant"||t.includes("assistant")||t.includes("agent"))return"assistant";if(t.includes("tool")||t.includes("action"))return"tool";const n=e.closest('[data-role], [class*="user"], [class*="assistant"], [class*="agent"]');if(n){const o=n.getAttribute("data-role")||n.className||"";if(o.includes("user"))return"user";if(o.includes("assistant")||o.includes("agent"))return"assistant"}return null}detectModel(){return"manus-agent"}}class O extends u{constructor(){super(...arguments);c(this,"platform","copilot")}start(){console.log("[CLO] Copilot interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{var s,n;const t=document.querySelector('[class*="conversation"]')||document.querySelector('[class*="chat-container"]')||document.querySelector('[id*="chat"]')||((n=(s=document.querySelector("cib-serp"))==null?void 0:s.shadowRoot)==null?void 0:n.querySelector('[class*="conversation"]'))||document.querySelector("main");t?this.observeContainer(t,'[class*="message"], [class*="response"], [class*="user-message"], [class*="bot-message"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.tagName.toLowerCase();if(t.includes("user")||t.includes("human")||s.includes("user"))return"user";if(t.includes("bot")||t.includes("response")||t.includes("assistant")||s.includes("bot"))return"assistant";const n=e.closest('[class*="user"], [class*="bot"], [class*="assistant"]');if(n){const o=n.className||"";if(o.includes("user"))return"user";if(o.includes("bot")||o.includes("assistant"))return"assistant"}return null}detectModel(){return"copilot"}}class A extends u{constructor(){super(...arguments);c(this,"platform","you")}start(){console.log("[CLO] You.com interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="chat-container"]')||document.querySelector('[class*="conversation"]')||document.querySelector('[data-testid="chat-messages"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="message"], [data-testid*="message"], [class*="chat-turn"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-testid")||"";if(t.includes("user")||s.includes("user"))return"user";if(t.includes("assistant")||t.includes("youchat")||s.includes("assistant"))return"assistant";const n=e.closest('[class*="user"], [class*="assistant"], [class*="youchat"]');if(n){const o=n.className||"";if(o.includes("user"))return"user";if(o.includes("assistant")||o.includes("youchat"))return"assistant"}return null}detectModel(){const e=document.querySelector('[class*="model-selector"], [data-testid="model-selector"]');return e!=null&&e.textContent?e.textContent.trim().toLowerCase():"you-smart"}}class F extends u{constructor(){super(...arguments);c(this,"platform","poe")}start(){console.log("[CLO] Poe interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="ChatMessages"]')||document.querySelector('[class*="chat-messages"]')||document.querySelector('[class*="MessageList"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="Message"], [class*="message"], [class*="ChatMessage"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"";if(t.includes("human")||t.includes("Human")||t.includes("user"))return"user";if(t.includes("bot")||t.includes("Bot")||t.includes("assistant"))return"assistant";const s=e.closest('[class*="human"], [class*="Human"], [class*="bot"], [class*="Bot"]');if(s){const n=s.className||"";if(n.includes("human")||n.includes("Human"))return"user";if(n.includes("bot")||n.includes("Bot"))return"assistant"}return null}detectModel(){const e=document.querySelector('[class*="BotHeader"] [class*="name"]')||document.querySelector('[class*="bot-name"]');return e!=null&&e.textContent?e.textContent.trim().toLowerCase():"poe-default"}}class I extends u{constructor(){super(...arguments);c(this,"platform","huggingchat")}start(){console.log("[CLO] HuggingChat interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="messages"]')||document.querySelector('[class*="conversation"]')||document.querySelector('[class*="chat-container"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="message"], [data-message-role], [class*="prose"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-message-role")||"";if(s==="user"||t.includes("user"))return"user";if(s==="assistant"||t.includes("assistant"))return"assistant";const n=e.closest('[data-message-role], [class*="user"], [class*="assistant"]');if(n){const o=n.getAttribute("data-message-role")||n.className||"";if(o.includes("user"))return"user";if(o.includes("assistant"))return"assistant"}return null}detectModel(){const e=document.querySelector('[class*="model-selector"]')||document.querySelector('select[name="model"]')||document.querySelector('button[class*="model"]');return e!=null&&e.textContent?e.textContent.trim().toLowerCase():"huggingchat-default"}}class D extends u{constructor(){super(...arguments);c(this,"platform","qwen")}start(){console.log("[CLO] Qwen interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="chat-container"]')||document.querySelector('[class*="message-list"]')||document.querySelector('[class*="conversation"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="message"], [data-role], [class*="chat-item"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-role")||"";if(s==="user"||t.includes("user"))return"user";if(s==="assistant"||t.includes("assistant")||t.includes("bot"))return"assistant";const n=e.closest('[data-role], [class*="user"], [class*="assistant"]');if(n){const o=n.getAttribute("data-role")||n.className||"";if(o.includes("user"))return"user";if(o.includes("assistant"))return"assistant"}return null}detectModel(){return"qwen-chat"}}class E extends u{constructor(){super(...arguments);c(this,"platform","mistral")}start(){console.log("[CLO] Mistral interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="conversation"]')||document.querySelector('[class*="chat-messages"]')||document.querySelector('[class*="message-list"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="message"], [data-role], [class*="Message"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-role")||"";if(s==="user"||t.includes("user"))return"user";if(s==="assistant"||t.includes("assistant"))return"assistant";const n=e.closest('[data-role], [class*="user"], [class*="assistant"]');if(n){const o=n.getAttribute("data-role")||n.className||"";if(o.includes("user"))return"user";if(o.includes("assistant"))return"assistant"}return null}detectModel(){const e=document.querySelector('[class*="model-selector"], [class*="ModelSelector"]');if(e!=null&&e.textContent){const t=e.textContent.trim().toLowerCase();return t.includes("large")?"mistral-large":t.includes("medium")?"mistral-medium":t.includes("small")?"mistral-small":t}return"mistral-chat"}}class H extends u{constructor(){super(...arguments);c(this,"platform","cohere")}start(){console.log("[CLO] Cohere interceptor started"),this.waitForConversationContainer()}waitForConversationContainer(){const e=()=>{const t=document.querySelector('[class*="conversation"]')||document.querySelector('[class*="messages"]')||document.querySelector('[class*="chat-container"]')||document.querySelector("main");t?this.observeContainer(t,'[class*="message"], [data-message-type], [class*="Message"]',this.detectRole.bind(this)):setTimeout(e,1e3)};e()}detectRole(e){const t=e.className||"",s=e.getAttribute("data-message-type")||"";if(s==="user"||t.includes("user"))return"user";if(s==="chatbot"||s==="assistant"||t.includes("assistant")||t.includes("bot"))return"assistant";const n=e.closest('[data-message-type], [class*="user"], [class*="assistant"], [class*="bot"]');if(n){const o=n.getAttribute("data-message-type")||n.className||"";if(o.includes("user"))return"user";if(o.includes("chatbot")||o.includes("assistant")||o.includes("bot"))return"assistant"}return null}detectModel(){return"command-r-plus"}}const P=[{platform:"chatgpt",patterns:[/chatgpt\.com/i,/chat\.openai\.com/i]},{platform:"claude",patterns:[/claude\.ai/i]},{platform:"gemini",patterns:[/gemini\.google\.com/i]},{platform:"grok",patterns:[/grok\.x\.ai/i,/x\.com\/i\/grok/i]},{platform:"perplexity",patterns:[/perplexity\.ai/i]},{platform:"deepseek",patterns:[/chat\.deepseek\.com/i,/deepseek\.com/i]},{platform:"kimi",patterns:[/kimi\.moonshot\.cn/i,/kimi\.com/i]},{platform:"manus",patterns:[/manus\.im/i,/manus\.ai/i]},{platform:"copilot",patterns:[/copilot\.microsoft\.com/i]},{platform:"you",patterns:[/you\.com/i]},{platform:"poe",patterns:[/poe\.com/i]},{platform:"huggingchat",patterns:[/huggingface\.co\/chat/i]},{platform:"qwen",patterns:[/tongyi\.aliyun\.com/i,/qwen\.ai/i,/chat\.qwen/i]},{platform:"mistral",patterns:[/chat\.mistral\.ai/i]},{platform:"cohere",patterns:[/coral\.cohere\.com/i,/dashboard\.cohere\.com/i]}];function U(a){const r=window.location.href;for(const{platform:e,patterns:t}of P)for(const s of t)if(s.test(r))return e;return"unknown"}function $(a){switch(a){case"chatgpt":return new q;case"claude":return new x;case"gemini":return new k;case"grok":return new L;case"perplexity":return new M;case"deepseek":return new R;case"kimi":return new T;case"manus":return new N;case"copilot":return new O;case"you":return new A;case"poe":return new F;case"huggingchat":return new I;case"qwen":return new D;case"mistral":return new E;case"cohere":return new H;default:return null}}let l=null,g=!1;function _(){if(l)return;l=document.createElement("div"),l.id="clo-hud",l.innerHTML=`
    <button id="clo-hud-toggle" title="CLO ‚Äî Cross-LLM Context Orchestrator">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
      </svg>
    </button>
    <div id="clo-hud-panel">
      <div class="clo-header">
        <span class="clo-logo">CLO</span>
        <span class="clo-status-dot" id="clo-status-dot"></span>
        <span style="flex:1"></span>
        <span style="font-size:10px;color:rgba(255,255,255,0.3);font-family:var(--clo-font-mono)">v0.1</span>
      </div>
      <div class="clo-platform" id="clo-platform-info">
        <span class="clo-platform-dot" id="clo-platform-dot"></span>
        <span id="clo-platform-name">Detecting...</span>
      </div>
      <div class="clo-stats">
        <div class="clo-stat">
          <div class="clo-stat-value" id="clo-stat-turns">0</div>
          <div class="clo-stat-label">Turns</div>
        </div>
        <div class="clo-stat">
          <div class="clo-stat-value" id="clo-stat-artifacts">0</div>
          <div class="clo-stat-label">Artifacts</div>
        </div>
        <div class="clo-stat">
          <div class="clo-stat-value" id="clo-stat-constraints">0</div>
          <div class="clo-stat-label">Constraints</div>
        </div>
        <div class="clo-stat">
          <div class="clo-stat-value" id="clo-stat-decisions">0</div>
          <div class="clo-stat-label">Decisions</div>
        </div>
      </div>
      <div class="clo-actions">
        <button class="clo-btn primary" id="clo-btn-inject">‚ö° Inject</button>
        <button class="clo-btn" id="clo-btn-export">üì§ Export</button>
        <button class="clo-btn" id="clo-btn-view">üëÅ View</button>
      </div>
    </div>
  `,document.body.appendChild(l);const a=l.querySelector("#clo-hud-toggle");a==null||a.addEventListener("click",()=>{g=!g,l==null||l.classList.toggle("minimized",g)});const r=l.querySelector("#clo-btn-inject");r==null||r.addEventListener("click",()=>{chrome.runtime.sendMessage({type:"INJECT_STATE",payload:{},timestamp:Date.now(),source:"content"})});const e=l.querySelector("#clo-btn-export");e==null||e.addEventListener("click",()=>{chrome.runtime.sendMessage({type:"EXPORT_STATE",payload:{},timestamp:Date.now(),source:"content"},s=>{if(s!=null&&s.state){const n=new Blob([JSON.stringify(s.state,null,2)],{type:"application/json"}),o=URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download=`clo-state-${Date.now()}.json`,i.click(),URL.revokeObjectURL(o),p("State exported ‚úì","success")}})});const t=l.querySelector("#clo-btn-view");t==null||t.addEventListener("click",()=>{chrome.runtime.sendMessage({type:"STATE_REQUEST",payload:{},timestamp:Date.now(),source:"content"},s=>{s!=null&&s.state&&(console.log("[CLO] Current Reasoning State:",s.state),p("State logged to console","info"))})})}function C(a){if(!l)return;const r=l.querySelector("#clo-platform-name"),e=l.querySelector("#clo-platform-dot");r&&(r.textContent=j(a.platform)),e&&(e.className=`clo-platform-dot ${a.platform}`);const t=l.querySelector("#clo-status-dot");t&&(t.className="clo-status-dot",a.status==="unsupported"&&t.classList.add("warning"),a.status==="idle"&&t.classList.add("error"));const s=l.querySelector("#clo-stat-turns");s&&(s.textContent=String(a.turns))}function p(a,r="info"){const e=document.querySelector("#clo-notification");e&&e.remove();const t=document.createElement("div");t.id="clo-notification",t.className=r,t.textContent=a,document.body.appendChild(t),requestAnimationFrame(()=>{t.classList.add("visible")}),setTimeout(()=>{t.classList.remove("visible"),setTimeout(()=>t.remove(),400)},3e3)}function j(a){return a.charAt(0).toUpperCase()+a.slice(1)}const m=U();m==="unknown"?console.log("[CLO] Not a supported platform, exiting."):(console.log(`[CLO] Detected platform: ${m}`),z());function z(){_(),C({platform:m,status:"active",turns:0}),p(`CLO active on ${m}`,"info"),v({type:"PLATFORM_DETECTED",payload:{platform:m,url:window.location.href},timestamp:Date.now(),source:"content"});const a=$(m);let r=0;if(a){a.onTurn(s=>{r++,console.log(`[CLO] Captured turn #${r}:`,s.role,s.content.slice(0,100)),C({platform:m,status:"capturing",turns:r}),v({type:"TURN_CAPTURED",payload:{turn:s,platform:m,model:s.model},timestamp:Date.now(),source:"content"})}),a.start(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&(console.log("[CLO] Tab became visible, re-scanning for messages..."),a.rescan())});let e=window.location.href;new MutationObserver(()=>{window.location.href!==e&&(e=window.location.href,console.log("[CLO] URL changed (SPA navigation), restarting interceptor..."),setTimeout(()=>{a.stop(),a.start()},1500))}).observe(document,{subtree:!0,childList:!0})}else C({platform:m,status:"unsupported",turns:0}),p(`Platform "${m}" not fully supported yet`,"warning");chrome.runtime.onMessage.addListener((e,t,s)=>{if(e.type==="INJECT_STATE"){const{text:n}=e.payload,o=w(n,m);p(o?"Context injected ‚úì":"Injection failed ‚Äî input not found",o?"success":"error"),s({success:o})}return e.type==="RESCAN"&&(console.log("[CLO] Received RESCAN command from background"),a&&a.rescan(),s({ok:!0})),!0})}function v(a){try{chrome.runtime.sendMessage(a)}catch(r){console.warn("[CLO] Failed to send message:",r)}}
